<!DOCTYPE html><html lang="en"><head>
<title>CSS4J DOM benchmarks</title>
<link href="basic-b.css" rel="stylesheet" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body id="dom-mark">
<div class="layout">
<div id="hdr01"></div>
<a id="mylinkhome" href="/"><span>CSS4J</span></a>
</div>
<div class="container">
<div class="menu">
<ul class="menulist">
<li><a id="mnuindice" href="/"><span>Home</span></a></li>
<li><a id="mnuusage" href="usage.html"><span>Usage</span></a></li>
<li><a id="mnuapi2" href="api/3/"><span>API 3.x</span></a></li>
<li><a id="mnufaq" href="faq.html"><span>FAQ</span></a></li>
<li><a id="mnubenchmarks" href="benchmarks.html"><span>Benchmarks</span></a></li>
<li class="menulvl2"><div id="mnudommark-sel"><span>DOM mark</span></div></li>
<li class="menulvl2"><a id="mnusacmark" href="sac-mark.html"><span>SAC mark</span></a></li>
<li><a id="mnugithub" href="https://github.com/css4j"><span>Github</span></a></li>
</ul>
</div>
<div class="beforemain"></div>
<div class="main">
<div id="presentacion_top" class="textheader"><span>DOM mark</span></div>
<div class="cos">
<h1>DOM benchmarks</h1>
<div class="tema" id="overview">
<h2>Overview</h2>
<p>The DOM benchmarks measure how fast different DOM implementations are when building and traversing documents:</p>
<ul>
<li><a href="https://github.com/css4j/css4j-dom4j">Css4j-DOM4J</a> module (which subclasses DOM4J).</li>
<li><a href="https://css4j.github.io/api/3/io/sf/carte/doc/dom/package-summary.html">Css4j's native DOM</a>.</li>
<li>Stand-alone <a href="https://dom4j.github.io/">DOM4J</a>.</li>
<li>JDK's bundled <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/org/w3c/dom/DOMImplementation.html">DOM implementation</a>.</li>
</ul>
<div class="subtema">
<p>The following software versions were used:</p>
<ul>
<li>Java: <a href="https://adoptopenjdk.net/">AdoptOpenJDK</a>* 15.</li>
<li>JMH: 1.26.</li>
<li>css4j: 3.2 (pre-release).</li>
<li>validator.nu htmlparser: <a href="https://search.maven.org/artifact/nu.validator/htmlparser">1.4.16</a>.</li>
<li>dom4j: 2.1.3.</li>
</ul>
</div>
<p>The tables and charts were generated by <a href="https://sourceforge.net/projects/carte/">Carte</a> (look for the <code>BenchmarkChartWriter</code>
class and the <code>examples</code> folder in the <code>carte-jmh</code> module). The grey lines at the top of the bars give the amplitude of the estimated error.</p>
<p>The computer has an Intel® Core™ i5-1035G7 CPU and 8GB of RAM. Unfortunately, being a laptop processor it is affected by thermal management,
which may explain some relatively large error intervals.</p>
<p class="note">(*) Note: one of the tested DOM implementations is the one that comes bundled with the JDK (identified as "JDK" in the graphics), and it has been observed
that the version shipped with the Oracle JDK may be faster.</p>
</div>
<div class="tema" id="html-build">
<h2>Build HTML documents</h2>
<p>Measures the speed at which the <a href="https://about.validator.nu/htmlparser/">validator.nu HTML parser</a> can build a small document (38 KB HTML) into a few DOM implementations.</p>
<svg version="1.1" baseprofile="full" xmlns="http://www.w3.org/2000/svg" width="700" height="500" viewbox="0 0 700 500" class="carteitem">
<title>HTML build benchmark</title><defs>
<clipPath id="html-build-cut-scale-shadow">
  <rect width="623" height="15" x="71" y="46"></rect>
  <rect width="8" height="418" x="685" y="42"></rect>
</clipPath>
<linearGradient id="html-build-background" gradientunits="objectBoundingBox" x1="1" x2="1" y1="0" y2="1">
<stop stop-color="#cde1ff" offset="0"></stop>
<stop stop-color="#ffffff" offset="0.9"></stop>
</linearGradient>
<linearGradient id="html-build-reflection" gradientunits="objectBoundingBox" x1="0" x2="0" y1="0" y2="1">
<stop stop-color="#eeeeee" offset="0" stop-opacity="0.4"></stop>
<stop stop-color="#ffffff" offset="0.75" stop-opacity="0"></stop>
</linearGradient>
<filter id="html-build-projection" filterunits="objectBoundingBox" x="0" y="-0.1" width="1.2" height="1.2">
<feGaussianBlur in="SourceAlpha" stddeviation="2" result="alpha_blur"></feGaussianBlur>
<feOffset in="alpha_blur" dx="3" dy="-3" result="offset_alpha_blur"></feOffset>
</filter>
</defs>
<style>
text {
  font-family: "Open Sans",Verdana,sans-serif;
}
#caption {
  font-size: 13pt;
  font-weight: 700;
}
#subcaption {
  font-size: 9pt;
  font-weight: 600;
}
#x-title,#y-title{
  font-size: 10pt;
  font-weight: 700;
}
.itemlabel {
  font-size: 10pt;
  font-weight: 400;
}
.scaleItem {
  font-size: 9pt;
  font-weight: 300;
}
</style>
<rect width="100%" height="100%" fill="url('#html-build-background')"></rect>
<rect width="610" height="400" x="75" y="60" stroke="#000000" fill="rgb(0,0,0)" fill-opacity="0" filter="url('#html-build-projection')" clip-path="url('#html-build-cut-scale-shadow')"></rect>
<rect id="html-build-chartbox" width="610" height="400" x="75" y="60" stroke-width="1" stroke="#000000" fill="rgb(0,0,0)" fill-opacity="0"></rect>
<text id="caption" x="355" y="22" text-anchor="middle" fill="black">HTML build benchmark</text>
<text id="subcaption" x="355" y="42" text-anchor="middle" fill="black">38 KB html file, validator.nu parser</text>
<rect width="187.0" height="342.7" x="81.5" y="117.3" stroke="#ffffff" stroke-opacity="0.4" filter="url('#html-build-projection')"></rect>
<rect id="html-build-markBuildCss4jDOM4J" width="187.0" height="342.7" x="81.5" y="117.3" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#c04d4d"></rect>
<rect width="187.0" height="342.7" x="81.5" y="117.3" fill="url('#html-build-reflection')"></rect>
<line x1="179.1" x2="179.1" y1="101.6" y2="132.4" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="174.1" y="475" class="itemlabel" text-anchor="middle" fill="black">Css4j-DOM4J</text>
<rect width="187.0" height="320.4" x="284.9" y="139.6" stroke="#ffffff" stroke-opacity="0.4" filter="url('#html-build-projection')"></rect>
<rect id="html-build-markBuildDOM" width="187.0" height="320.4" x="284.9" y="139.6" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#61c061"></rect>
<rect width="187.0" height="320.4" x="284.9" y="139.6" fill="url('#html-build-reflection')"></rect>
<line x1="382.5" x2="382.5" y1="138.1" y2="141.9" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="377.4" y="475" class="itemlabel" text-anchor="middle" fill="black">Css4j DOM</text>
<rect width="187.0" height="326.7" x="488.2" y="133.3" stroke="#ffffff" stroke-opacity="0.4" filter="url('#html-build-projection')"></rect>
<rect id="html-build-markBuildPlainJDK" width="187.0" height="326.7" x="488.2" y="133.3" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#c0c061"></rect>
<rect width="187.0" height="326.7" x="488.2" y="133.3" fill="url('#html-build-reflection')"></rect>
<line x1="585.8" x2="585.8" y1="130.8" y2="135.2" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="580.7" y="475" class="itemlabel" text-anchor="middle" fill="black">JDK</text>
<text x="74" y="64" class="scaleitem" text-anchor="end">400</text>
<text x="74" y="264" class="scaleitem" text-anchor="end">200</text>
<text x="74" y="464" class="scaleitem" text-anchor="end">0</text>
<text id="y-title" x="16" y="260" text-anchor="middle" fill="black" transform="rotate(270,16,260)">Throughput (ops/s)</text>
<text id="x-title" x="350" y="496" text-anchor="middle" fill="black"></text>
<image src="benchmark/html-build.png" xlink:href=""></image></svg>
<p>Numeric results (higher is better):</p>
<table class="normaltbl carteitem">
<thead><tr><th>Implementation</th><th>Score</th><th>Error</th><th>Unit</th></tr></thead><tbody>
<tr><td>Css4j-DOM4J</td><td class="number">346.141</td><td class="number">±15.570</td><td>ops/s</td></tr>
<tr><td>Css4j DOM</td><td class="number">323.596</td><td class="number">±1.869</td><td>ops/s</td></tr>
<tr><td>JDK</td><td class="number">330.047</td><td class="number">±2.259</td><td>ops/s</td></tr>
</tbody></table>
<p>If one looks at the error figures, the three implementations are somewhat even in this test. Plain DOM4J is not included in the benchmark,
as it cannot be used with <code>HtmlDocumentBuilder</code>.</p>
</div>
<div class="tema" id="xml-build-small">
<h2>Build small XML documents</h2>
<p>The SAX parser that comes bundled with the JDK is used to parse and build a document from a small XHTML file (38 KB).</p>
<svg version="1.1" baseprofile="full" xmlns="http://www.w3.org/2000/svg" width="700" height="500" viewbox="0 0 700 500" class="carteitem">
<title>XML build benchmark</title><defs>
<clipPath id="xml-build-small-cut-scale-shadow">
  <rect width="623" height="15" x="71" y="46"></rect>
  <rect width="8" height="418" x="685" y="42"></rect>
</clipPath>
<linearGradient id="xml-build-small-background" gradientunits="objectBoundingBox" x1="1" x2="1" y1="0" y2="1">
<stop stop-color="#cde1ff" offset="0"></stop>
<stop stop-color="#ffffff" offset="0.9"></stop>
</linearGradient>
<linearGradient id="xml-build-small-reflection" gradientunits="objectBoundingBox" x1="0" x2="0" y1="0" y2="1">
<stop stop-color="#eeeeee" offset="0" stop-opacity="0.4"></stop>
<stop stop-color="#ffffff" offset="0.75" stop-opacity="0"></stop>
</linearGradient>
<filter id="xml-build-small-projection" filterunits="objectBoundingBox" x="0" y="-0.1" width="1.2" height="1.2">
<feGaussianBlur in="SourceAlpha" stddeviation="2" result="alpha_blur"></feGaussianBlur>
<feOffset in="alpha_blur" dx="3" dy="-3" result="offset_alpha_blur"></feOffset>
</filter>
</defs>
<style>
text {
  font-family: "Open Sans",Verdana,sans-serif;
}
#caption {
  font-size: 13pt;
  font-weight: 700;
}
#subcaption {
  font-size: 9pt;
  font-weight: 600;
}
#x-title,#y-title{
  font-size: 10pt;
  font-weight: 700;
}
.itemlabel {
  font-size: 10pt;
  font-weight: 400;
}
.scaleItem {
  font-size: 9pt;
  font-weight: 300;
}
</style>
<rect width="100%" height="100%" fill="url('#xml-build-small-background')"></rect>
<rect width="610" height="400" x="75" y="60" stroke="#000000" fill="rgb(0,0,0)" fill-opacity="0" filter="url('#xml-build-small-projection')" clip-path="url('#xml-build-small-cut-scale-shadow')"></rect>
<rect id="xml-build-small-chartbox" width="610" height="400" x="75" y="60" stroke-width="1" stroke="#000000" fill="rgb(0,0,0)" fill-opacity="0"></rect>
<text id="caption" x="355" y="22" text-anchor="middle" fill="black">XML build benchmark</text>
<text id="subcaption" x="355" y="42" text-anchor="middle" fill="black">38kB file</text>
<rect width="108.0" height="326" x="80.6" y="134" stroke="#ffffff" stroke-opacity="0.4" filter="url('#xml-build-small-projection')"></rect>
<rect id="xml-build-small-markBuildCss4jDOM4J" width="108.0" height="326" x="80.6" y="134" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#c04d4d"></rect>
<rect width="108.0" height="326" x="80.6" y="134" fill="url('#xml-build-small-reflection')"></rect>
<line x1="139.2" x2="139.2" y1="121.6" y2="146.4" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="136.1" y="475" class="itemlabel" text-anchor="middle" fill="black">Css4j-DOM4J</text>
<rect width="108.0" height="331.8" x="202.6" y="128.2" stroke="#ffffff" stroke-opacity="0.4" filter="url('#xml-build-small-projection')"></rect>
<rect id="xml-build-small-markBuildDOM" width="108.0" height="331.8" x="202.6" y="128.2" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#61c061"></rect>
<rect width="108.0" height="331.8" x="202.6" y="128.2" fill="url('#xml-build-small-reflection')"></rect>
<line x1="261.2" x2="261.2" y1="125.8" y2="130.2" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="258.1" y="475" class="itemlabel" text-anchor="middle" fill="black">Css4j DOM</text>
<rect width="108.0" height="347.6" x="324.6" y="112.4" stroke="#ffffff" stroke-opacity="0.4" filter="url('#xml-build-small-projection')"></rect>
<rect id="xml-build-small-markBuildDOM4J" width="108.0" height="347.6" x="324.6" y="112.4" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#4d4dc0"></rect>
<rect width="108.0" height="347.6" x="324.6" y="112.4" fill="url('#xml-build-small-reflection')"></rect>
<line x1="383.2" x2="383.2" y1="101.4" y2="122.6" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="380.1" y="475" class="itemlabel" text-anchor="middle" fill="black">DOM4J</text>
<rect width="108.0" height="315.7" x="446.6" y="144.3" stroke="#ffffff" stroke-opacity="0.4" filter="url('#xml-build-small-projection')"></rect>
<rect id="xml-build-small-markBuildJdk" width="108.0" height="315.7" x="446.6" y="144.3" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#c04dc0"></rect>
<rect width="108.0" height="315.7" x="446.6" y="144.3" fill="url('#xml-build-small-reflection')"></rect>
<line x1="505.2" x2="505.2" y1="141.3" y2="146.7" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="502.1" y="475" class="itemlabel" text-anchor="middle" fill="black">JDK (css4j builder)</text>
<rect width="108.0" height="332.7" x="568.6" y="127.3" stroke="#ffffff" stroke-opacity="0.4" filter="url('#xml-build-small-projection')"></rect>
<rect id="xml-build-small-markBuildPlainJdk" width="108.0" height="332.7" x="568.6" y="127.3" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#c0c061"></rect>
<rect width="108.0" height="332.7" x="568.6" y="127.3" fill="url('#xml-build-small-reflection')"></rect>
<line x1="627.2" x2="627.2" y1="125.4" y2="128.6" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="624.1" y="475" class="itemlabel" text-anchor="middle" fill="black">JDK</text>
<text x="74" y="64" class="scaleitem" text-anchor="end">600</text>
<text x="74" y="197" class="scaleitem" text-anchor="end">400</text>
<text x="74" y="331" class="scaleitem" text-anchor="end">200</text>
<text x="74" y="464" class="scaleitem" text-anchor="end">0</text>
<text id="y-title" x="16" y="260" text-anchor="middle" fill="black" transform="rotate(270,16,260)">Throughput (ops/s)</text>
<text id="x-title" x="350" y="496" text-anchor="middle" fill="black"></text>
<image src="benchmark/xml-build-small.png" xlink:href=""></image></svg>
<p>Numeric results (higher is better):</p>
<table class="normaltbl carteitem">
<thead><tr><th>Implementation</th><th>Score</th><th>Error</th><th>Unit</th></tr></thead><tbody>
<tr><td>Css4j-DOM4J</td><td class="number">493.953</td><td class="number">±18.752</td><td>ops/s</td></tr>
<tr><td>Css4j DOM</td><td class="number">502.769</td><td class="number">±3.360</td><td>ops/s</td></tr>
<tr><td>DOM4J</td><td class="number">526.698</td><td class="number">±16.103</td><td>ops/s</td></tr>
<tr><td>JDK (css4j builder)</td><td class="number">478.381</td><td class="number">±4.051</td><td>ops/s</td></tr>
<tr><td>JDK</td><td class="number">504.017</td><td class="number">±2.493</td><td>ops/s</td></tr>
</tbody></table>
</div>
<div class="tema" id="xml-build">
<h2>Build XML documents</h2>
<p>The SAX parser that comes bundled with the JDK is used to parse and build a document (1MB file).</p>
<svg version="1.1" baseprofile="full" xmlns="http://www.w3.org/2000/svg" width="700" height="500" viewbox="0 0 700 500" class="carteitem">
<title>XML build benchmark</title><defs>
<clipPath id="xml-build-cut-scale-shadow">
  <rect width="623" height="15" x="71" y="46"></rect>
  <rect width="8" height="418" x="685" y="42"></rect>
</clipPath>
<linearGradient id="xml-build-background" gradientunits="objectBoundingBox" x1="1" x2="1" y1="0" y2="1">
<stop stop-color="#cde1ff" offset="0"></stop>
<stop stop-color="#ffffff" offset="0.9"></stop>
</linearGradient>
<linearGradient id="xml-build-reflection" gradientunits="objectBoundingBox" x1="0" x2="0" y1="0" y2="1">
<stop stop-color="#eeeeee" offset="0" stop-opacity="0.4"></stop>
<stop stop-color="#ffffff" offset="0.75" stop-opacity="0"></stop>
</linearGradient>
<filter id="xml-build-projection" filterunits="objectBoundingBox" x="0" y="-0.1" width="1.2" height="1.2">
<feGaussianBlur in="SourceAlpha" stddeviation="2" result="alpha_blur"></feGaussianBlur>
<feOffset in="alpha_blur" dx="3" dy="-3" result="offset_alpha_blur"></feOffset>
</filter>
</defs>
<style>
text {
  font-family: "Open Sans",Verdana,sans-serif;
}
#caption {
  font-size: 13pt;
  font-weight: 700;
}
#subcaption {
  font-size: 9pt;
  font-weight: 600;
}
#x-title,#y-title{
  font-size: 10pt;
  font-weight: 700;
}
.itemlabel {
  font-size: 10pt;
  font-weight: 400;
}
.scaleItem {
  font-size: 9pt;
  font-weight: 300;
}
</style>
<rect width="100%" height="100%" fill="url('#xml-build-background')"></rect>
<rect width="610" height="400" x="75" y="60" stroke="#000000" fill="rgb(0,0,0)" fill-opacity="0" filter="url('#xml-build-projection')" clip-path="url('#xml-build-cut-scale-shadow')"></rect>
<rect id="xml-build-chartbox" width="610" height="400" x="75" y="60" stroke-width="1" stroke="#000000" fill="rgb(0,0,0)" fill-opacity="0"></rect>
<text id="caption" x="355" y="22" text-anchor="middle" fill="black">XML build benchmark</text>
<text id="subcaption" x="355" y="42" text-anchor="middle" fill="black">1MB file</text>
<rect width="108.0" height="322.2" x="80.6" y="137.8" stroke="#ffffff" stroke-opacity="0.4" filter="url('#xml-build-projection')"></rect>
<rect id="xml-build-markBuildCss4jDOM4J" width="108.0" height="322.2" x="80.6" y="137.8" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#c04d4d"></rect>
<rect width="108.0" height="322.2" x="80.6" y="137.8" fill="url('#xml-build-reflection')"></rect>
<line x1="139.2" x2="139.2" y1="121.7" y2="154.3" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="136.1" y="475" class="itemlabel" text-anchor="middle" fill="black">Css4j-DOM4J</text>
<rect width="108.0" height="301.2" x="202.6" y="158.8" stroke="#ffffff" stroke-opacity="0.4" filter="url('#xml-build-projection')"></rect>
<rect id="xml-build-markBuildDOM" width="108.0" height="301.2" x="202.6" y="158.8" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#61c061"></rect>
<rect width="108.0" height="301.2" x="202.6" y="158.8" fill="url('#xml-build-reflection')"></rect>
<line x1="261.2" x2="261.2" y1="156.3" y2="161.7" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="258.1" y="475" class="itemlabel" text-anchor="middle" fill="black">Css4j DOM</text>
<rect width="108.0" height="341.3" x="324.6" y="118.7" stroke="#ffffff" stroke-opacity="0.4" filter="url('#xml-build-projection')"></rect>
<rect id="xml-build-markBuildDOM4J" width="108.0" height="341.3" x="324.6" y="118.7" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#4d4dc0"></rect>
<rect width="108.0" height="341.3" x="324.6" y="118.7" fill="url('#xml-build-reflection')"></rect>
<line x1="383.2" x2="383.2" y1="99.9" y2="138.1" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="380.1" y="475" class="itemlabel" text-anchor="middle" fill="black">DOM4J</text>
<rect width="108.0" height="245.4" x="446.6" y="214.6" stroke="#ffffff" stroke-opacity="0.4" filter="url('#xml-build-projection')"></rect>
<rect id="xml-build-markBuildJdk" width="108.0" height="245.4" x="446.6" y="214.6" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#c04dc0"></rect>
<rect width="108.0" height="245.4" x="446.6" y="214.6" fill="url('#xml-build-reflection')"></rect>
<line x1="505.2" x2="505.2" y1="210.8" y2="219.2" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="502.1" y="475" class="itemlabel" text-anchor="middle" fill="black">JDK (css4j builder)</text>
<rect width="108.0" height="330.9" x="568.6" y="129.1" stroke="#ffffff" stroke-opacity="0.4" filter="url('#xml-build-projection')"></rect>
<rect id="xml-build-markBuildPlainJdk" width="108.0" height="330.9" x="568.6" y="129.1" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#c0c061"></rect>
<rect width="108.0" height="330.9" x="568.6" y="129.1" fill="url('#xml-build-reflection')"></rect>
<line x1="627.2" x2="627.2" y1="124.6" y2="133.4" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="624.1" y="475" class="itemlabel" text-anchor="middle" fill="black">JDK</text>
<text x="74" y="64" class="scaleitem" text-anchor="end">120</text>
<text x="74" y="131" class="scaleitem" text-anchor="end">100</text>
<text x="74" y="197" class="scaleitem" text-anchor="end">80</text>
<text x="74" y="264" class="scaleitem" text-anchor="end">60</text>
<text x="74" y="331" class="scaleitem" text-anchor="end">40</text>
<text x="74" y="397" class="scaleitem" text-anchor="end">20</text>
<text x="74" y="464" class="scaleitem" text-anchor="end">0</text>
<text id="y-title" x="16" y="260" text-anchor="middle" fill="black" transform="rotate(270,16,260)">Throughput (ops/s)</text>
<text id="x-title" x="350" y="496" text-anchor="middle" fill="black">DOM Implementation</text>
<image src="benchmark/xml-build.png" xlink:href=""></image></svg>
<p>Numeric results (higher is better):</p>
<table class="normaltbl carteitem">
<thead><tr><th>Implementation</th><th>Score</th><th>Error</th><th>Unit</th></tr></thead><tbody>
<tr><td>Css4j-DOM4J</td><td class="number">97.624</td><td class="number">±4.932</td><td>ops/s</td></tr>
<tr><td>Css4j DOM</td><td class="number">91.260</td><td class="number">±0.833</td><td>ops/s</td></tr>
<tr><td>DOM4J</td><td class="number">103.412</td><td class="number">±5.790</td><td>ops/s</td></tr>
<tr><td>JDK (css4j builder)</td><td class="number">74.366</td><td class="number">±1.288</td><td>ops/s</td></tr>
<tr><td>JDK</td><td class="number">100.270</td><td class="number">±1.335</td><td>ops/s</td></tr>
</tbody></table>
</div>
<div class="tema" id="traversal-next">
<h2>DOM traversal: <code>getFirstChild()/getNextSibling()</code></h2>
<p>Count the nodes of an XML document, using a combination of <code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/org/w3c/dom/Node.html#getFirstChild()">getFirstChild()</a>/<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/org/w3c/dom/Node.html#getNextSibling()">getNextSibling()</a></code> to traverse it.</p>
<svg version="1.1" baseprofile="full" xmlns="http://www.w3.org/2000/svg" width="700" height="500" viewbox="0 0 700 500" class="carteitem">
<title>DOM Traversal</title><defs>
<clipPath id="traversal-next-cut-scale-shadow">
  <rect width="623" height="15" x="71" y="46"></rect>
  <rect width="8" height="418" x="685" y="42"></rect>
</clipPath>
<linearGradient id="traversal-next-background" gradientunits="objectBoundingBox" x1="1" x2="1" y1="0" y2="1">
<stop stop-color="#cde1ff" offset="0"></stop>
<stop stop-color="#ffffff" offset="0.9"></stop>
</linearGradient>
<linearGradient id="traversal-next-reflection" gradientunits="objectBoundingBox" x1="0" x2="0" y1="0" y2="1">
<stop stop-color="#eeeeee" offset="0" stop-opacity="0.4"></stop>
<stop stop-color="#ffffff" offset="0.75" stop-opacity="0"></stop>
</linearGradient>
<filter id="traversal-next-projection" filterunits="objectBoundingBox" x="0" y="-0.1" width="1.2" height="1.2">
<feGaussianBlur in="SourceAlpha" stddeviation="2" result="alpha_blur"></feGaussianBlur>
<feOffset in="alpha_blur" dx="3" dy="-3" result="offset_alpha_blur"></feOffset>
</filter>
</defs>
<style>
text {
  font-family: "Open Sans",Verdana,sans-serif;
}
#caption {
  font-size: 13pt;
  font-weight: 700;
}
#subcaption {
  font-size: 9pt;
  font-weight: 600;
}
#x-title,#y-title{
  font-size: 10pt;
  font-weight: 700;
}
.itemlabel {
  font-size: 10pt;
  font-weight: 400;
}
.scaleItem {
  font-size: 9pt;
  font-weight: 300;
}
</style>
<rect width="100%" height="100%" fill="url('#traversal-next-background')"></rect>
<rect width="610" height="400" x="75" y="60" stroke="#000000" fill="rgb(0,0,0)" fill-opacity="0" filter="url('#traversal-next-projection')" clip-path="url('#traversal-next-cut-scale-shadow')"></rect>
<rect id="traversal-next-chartbox" width="610" height="400" x="75" y="60" stroke-width="1" stroke="#000000" fill="rgb(0,0,0)" fill-opacity="0"></rect>
<text id="caption" x="355" y="22" text-anchor="middle" fill="black">DOM Traversal</text>
<text id="subcaption" x="355" y="42" text-anchor="middle" fill="black">1MB file traversed by getFirstChild()/getNextSibling()</text>
<rect width="187.0" height="156.4" x="81.5" y="303.6" stroke="#ffffff" stroke-opacity="0.4" filter="url('#traversal-next-projection')"></rect>
<rect id="traversal-next-markTraverseDOM" width="187.0" height="156.4" x="81.5" y="303.6" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#61c061"></rect>
<rect width="187.0" height="156.4" x="81.5" y="303.6" fill="url('#traversal-next-reflection')"></rect>
<line x1="179.1" x2="179.1" y1="293.9" y2="314.1" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="174.1" y="475" class="itemlabel" text-anchor="middle" fill="black">Css4j DOM</text>
<rect width="187.0" height="10.5" x="284.9" y="449.5" stroke="#ffffff" stroke-opacity="0.4" filter="url('#traversal-next-projection')"></rect>
<rect id="traversal-next-markTraverseDOM4J" width="187.0" height="10.5" x="284.9" y="449.5" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#c04d4d"></rect>
<rect width="187.0" height="10.5" x="284.9" y="449.5" fill="url('#traversal-next-reflection')"></rect>
<line x1="382.5" x2="382.5" y1="447.2" y2="452.8" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="377.4" y="475" class="itemlabel" text-anchor="middle" fill="black">Css4j-DOM4J</text>
<rect width="187.0" height="318.4" x="488.2" y="141.6" stroke="#ffffff" stroke-opacity="0.4" filter="url('#traversal-next-projection')"></rect>
<rect id="traversal-next-markTraverseJdk" width="187.0" height="318.4" x="488.2" y="141.6" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#c0c061"></rect>
<rect width="187.0" height="318.4" x="488.2" y="141.6" fill="url('#traversal-next-reflection')"></rect>
<line x1="585.8" x2="585.8" y1="133" y2="151" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="580.7" y="475" class="itemlabel" text-anchor="middle" fill="black">JDK</text>
<text x="74" y="64" class="scaleitem" text-anchor="end">8000</text>
<text x="74" y="164" class="scaleitem" text-anchor="end">6000</text>
<text x="74" y="264" class="scaleitem" text-anchor="end">4000</text>
<text x="74" y="364" class="scaleitem" text-anchor="end">2000</text>
<text x="74" y="464" class="scaleitem" text-anchor="end">0</text>
<text id="y-title" x="16" y="260" text-anchor="middle" fill="black" transform="rotate(270,16,260)">Throughput (ops/s)</text>
<text id="x-title" x="350" y="496" text-anchor="middle" fill="black"></text>
<image src="benchmark/traversal-next.png" xlink:href=""></image></svg>
<p>Numeric results (higher is better):</p>
<table class="normaltbl carteitem">
<thead><tr><th>Implementation</th><th>Score</th><th>Error</th><th>Unit</th></tr></thead><tbody>
<tr><td>Css4j DOM</td><td class="number">3,159.362</td><td class="number">±204.594</td><td>ops/s</td></tr>
<tr><td>Css4j-DOM4J</td><td class="number">211.824</td><td class="number">±57.079</td><td>ops/s</td></tr>
<tr><td>JDK</td><td class="number">6,432.736</td><td class="number">±181.402</td><td>ops/s</td></tr>
</tbody></table>
<p><em>Note:</em> for unknown reasons, the usual procedure to build the JDK document with a <code>DocumentBuilderFactory</code> could not be used to initialize the document
traversed in the benchmark, as that document is somehow left in an inconsistent state with no child nodes; this happened with the initialization code being executed in a
<code>Scope.Benchmark</code> class and also when in a <code>static</code> initialization block. When that same code is executed in a JUnit test, the problem is not seen.</p>
<p>Because of this reason the JDK DOM document was built with css4j's <a href="https://css4j.github.io/api/3/io/sf/carte/doc/dom/XMLDocumentBuilder.html"><code>XMLDocumentBuilder</code></a>,
although that process is not part of the timed benchmark.</p>
</div>
<div class="tema" id="traversal-prev">
<h2>DOM traversal: <code>getLastChild()/getPreviousSibling()</code></h2>
<p>Count the nodes of an XML document, using a combination of <code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/org/w3c/dom/Node.html#getLastChild()">getLastChild()</a>/<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/org/w3c/dom/Node.html#getPreviousSibling()">getPreviousSibling()</a></code> to traverse it.</p>
<svg version="1.1" baseprofile="full" xmlns="http://www.w3.org/2000/svg" width="700" height="500" viewbox="0 0 700 500" class="carteitem">
<title>DOM Traversal</title><defs>
<clipPath id="traversal-prev-cut-scale-shadow">
  <rect width="623" height="15" x="71" y="46"></rect>
  <rect width="8" height="418" x="685" y="42"></rect>
</clipPath>
<linearGradient id="traversal-prev-background" gradientunits="objectBoundingBox" x1="1" x2="1" y1="0" y2="1">
<stop stop-color="#cde1ff" offset="0"></stop>
<stop stop-color="#ffffff" offset="0.9"></stop>
</linearGradient>
<linearGradient id="traversal-prev-reflection" gradientunits="objectBoundingBox" x1="0" x2="0" y1="0" y2="1">
<stop stop-color="#eeeeee" offset="0" stop-opacity="0.4"></stop>
<stop stop-color="#ffffff" offset="0.75" stop-opacity="0"></stop>
</linearGradient>
<filter id="traversal-prev-projection" filterunits="objectBoundingBox" x="0" y="-0.1" width="1.2" height="1.2">
<feGaussianBlur in="SourceAlpha" stddeviation="2" result="alpha_blur"></feGaussianBlur>
<feOffset in="alpha_blur" dx="3" dy="-3" result="offset_alpha_blur"></feOffset>
</filter>
</defs>
<style>
text {
  font-family: "Open Sans",Verdana,sans-serif;
}
#caption {
  font-size: 13pt;
  font-weight: 700;
}
#subcaption {
  font-size: 9pt;
  font-weight: 600;
}
#x-title,#y-title{
  font-size: 10pt;
  font-weight: 700;
}
.itemlabel {
  font-size: 10pt;
  font-weight: 400;
}
.scaleItem {
  font-size: 9pt;
  font-weight: 300;
}
</style>
<rect width="100%" height="100%" fill="url('#traversal-prev-background')"></rect>
<rect width="610" height="400" x="75" y="60" stroke="#000000" fill="rgb(0,0,0)" fill-opacity="0" filter="url('#traversal-prev-projection')" clip-path="url('#traversal-prev-cut-scale-shadow')"></rect>
<rect id="traversal-prev-chartbox" width="610" height="400" x="75" y="60" stroke-width="1" stroke="#000000" fill="rgb(0,0,0)" fill-opacity="0"></rect>
<text id="caption" x="355" y="22" text-anchor="middle" fill="black">DOM Traversal</text>
<text id="subcaption" x="355" y="42" text-anchor="middle" fill="black">1MB file traversed by getLastChild()/getPreviousSibling()</text>
<rect width="187.0" height="136.1" x="81.5" y="323.9" stroke="#ffffff" stroke-opacity="0.4" filter="url('#traversal-prev-projection')"></rect>
<rect id="traversal-prev-markTraversePrevDOM" width="187.0" height="136.1" x="81.5" y="323.9" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#61c061"></rect>
<rect width="187.0" height="136.1" x="81.5" y="323.9" fill="url('#traversal-prev-reflection')"></rect>
<line x1="179.1" x2="179.1" y1="308.5" y2="339.5" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="174.1" y="475" class="itemlabel" text-anchor="middle" fill="black">Css4j DOM</text>
<rect width="187.0" height="8.1" x="284.9" y="451.9" stroke="#ffffff" stroke-opacity="0.4" filter="url('#traversal-prev-projection')"></rect>
<rect id="traversal-prev-markTraversePrevDOM4J" width="187.0" height="8.1" x="284.9" y="451.9" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#c04d4d"></rect>
<rect width="187.0" height="8.1" x="284.9" y="451.9" fill="url('#traversal-prev-reflection')"></rect>
<line x1="382.5" x2="382.5" y1="451.4" y2="452.6" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="377.4" y="475" class="itemlabel" text-anchor="middle" fill="black">Css4j-DOM4J</text>
<rect width="187.0" height="355.4" x="488.2" y="104.6" stroke="#ffffff" stroke-opacity="0.4" filter="url('#traversal-prev-projection')"></rect>
<rect id="traversal-prev-markTraversePrevJdk" width="187.0" height="355.4" x="488.2" y="104.6" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#c0c061"></rect>
<rect width="187.0" height="355.4" x="488.2" y="104.6" fill="url('#traversal-prev-reflection')"></rect>
<line x1="585.8" x2="585.8" y1="96.1" y2="113.9" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="580.7" y="475" class="itemlabel" text-anchor="middle" fill="black">JDK</text>
<text x="74" y="64" class="scaleitem" text-anchor="end">8000</text>
<text x="74" y="164" class="scaleitem" text-anchor="end">6000</text>
<text x="74" y="264" class="scaleitem" text-anchor="end">4000</text>
<text x="74" y="364" class="scaleitem" text-anchor="end">2000</text>
<text x="74" y="464" class="scaleitem" text-anchor="end">0</text>
<text id="y-title" x="16" y="260" text-anchor="middle" fill="black" transform="rotate(270,16,260)">Throughput (ops/s)</text>
<text id="x-title" x="350" y="496" text-anchor="middle" fill="black"></text>
<image src="benchmark/traversal-prev.png" xlink:href=""></image></svg>
<p>Numeric results (higher is better):</p>
<table class="normaltbl carteitem">
<thead><tr><th>Implementation</th><th>Score</th><th>Error</th><th>Unit</th></tr></thead><tbody>
<tr><td>Css4j DOM</td><td class="number">2,748.676</td><td class="number">±312.752</td><td>ops/s</td></tr>
<tr><td>Css4j-DOM4J</td><td class="number">163.033</td><td class="number">±12.672</td><td>ops/s</td></tr>
<tr><td>JDK</td><td class="number">7,179.106</td><td class="number">±179.919</td><td>ops/s</td></tr>
</tbody></table>
<p>The Css4j-DOM4J results are representative for DOM4J as well.</p>
</div>
<div class="tema" id="nodeiterator">
<h2>DOM traversal: <code>NodeIterator</code></h2>
<p>Count the elements of an XML document traversed by a <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/org/w3c/dom/traversal/NodeIterator.html"><code>NodeIterator</code></a>.</p>
<svg version="1.1" baseprofile="full" xmlns="http://www.w3.org/2000/svg" width="700" height="500" viewbox="0 0 700 500" class="carteitem">
<title>DOM Traversal</title><defs>
<clipPath id="nodeiterator-cut-scale-shadow">
  <rect width="623" height="15" x="71" y="46"></rect>
  <rect width="8" height="418" x="685" y="42"></rect>
</clipPath>
<linearGradient id="nodeiterator-background" gradientunits="objectBoundingBox" x1="1" x2="1" y1="0" y2="1">
<stop stop-color="#cde1ff" offset="0"></stop>
<stop stop-color="#ffffff" offset="0.9"></stop>
</linearGradient>
<linearGradient id="nodeiterator-reflection" gradientunits="objectBoundingBox" x1="0" x2="0" y1="0" y2="1">
<stop stop-color="#eeeeee" offset="0" stop-opacity="0.4"></stop>
<stop stop-color="#ffffff" offset="0.75" stop-opacity="0"></stop>
</linearGradient>
<filter id="nodeiterator-projection" filterunits="objectBoundingBox" x="0" y="-0.1" width="1.2" height="1.2">
<feGaussianBlur in="SourceAlpha" stddeviation="2" result="alpha_blur"></feGaussianBlur>
<feOffset in="alpha_blur" dx="3" dy="-3" result="offset_alpha_blur"></feOffset>
</filter>
</defs>
<style>
text {
  font-family: "Open Sans",Verdana,sans-serif;
}
#caption {
  font-size: 13pt;
  font-weight: 700;
}
#subcaption {
  font-size: 9pt;
  font-weight: 600;
}
#x-title,#y-title{
  font-size: 10pt;
  font-weight: 700;
}
.itemlabel {
  font-size: 10pt;
  font-weight: 400;
}
.scaleItem {
  font-size: 9pt;
  font-weight: 300;
}
</style>
<rect width="100%" height="100%" fill="url('#nodeiterator-background')"></rect>
<rect width="610" height="400" x="75" y="60" stroke="#000000" fill="rgb(0,0,0)" fill-opacity="0" filter="url('#nodeiterator-projection')" clip-path="url('#nodeiterator-cut-scale-shadow')"></rect>
<rect id="nodeiterator-chartbox" width="610" height="400" x="75" y="60" stroke-width="1" stroke="#000000" fill="rgb(0,0,0)" fill-opacity="0"></rect>
<text id="caption" x="355" y="22" text-anchor="middle" fill="black">DOM Traversal</text>
<text id="subcaption" x="355" y="42" text-anchor="middle" fill="black">1MB file traversed by NodeIterator</text>
<rect width="285.0" height="146.1" x="83" y="313.9" stroke="#ffffff" stroke-opacity="0.4" filter="url('#nodeiterator-projection')"></rect>
<rect id="nodeiterator-markNodeIteratorDOM" width="285.0" height="146.1" x="83" y="313.9" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#61c061"></rect>
<rect width="285.0" height="146.1" x="83" y="313.9" fill="url('#nodeiterator-reflection')"></rect>
<line x1="229.4" x2="229.4" y1="311.4" y2="316.6" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="221.8" y="475" class="itemlabel" text-anchor="middle" fill="black">Css4j DOM</text>
<rect width="285.0" height="292.1" x="388" y="167.9" stroke="#ffffff" stroke-opacity="0.4" filter="url('#nodeiterator-projection')"></rect>
<rect id="nodeiterator-markNodeIteratorJdk" width="285.0" height="292.1" x="388" y="167.9" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#c0c061"></rect>
<rect width="285.0" height="292.1" x="388" y="167.9" fill="url('#nodeiterator-reflection')"></rect>
<line x1="534.4" x2="534.4" y1="158.7" y2="177.3" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="526.8" y="475" class="itemlabel" text-anchor="middle" fill="black">JDK</text>
<text x="74" y="64" class="scaleitem" text-anchor="end">6000</text>
<text x="74" y="197" class="scaleitem" text-anchor="end">4000</text>
<text x="74" y="331" class="scaleitem" text-anchor="end">2000</text>
<text x="74" y="464" class="scaleitem" text-anchor="end">0</text>
<text id="y-title" x="16" y="260" text-anchor="middle" fill="black" transform="rotate(270,16,260)">Throughput (ops/s)</text>
<text id="x-title" x="350" y="496" text-anchor="middle" fill="black"></text>
<image src="benchmark/nodeiterator.png" xlink:href=""></image></svg>
<p>Numeric results (higher is better):</p>
<table class="normaltbl carteitem">
<thead><tr><th>Implementation</th><th>Score</th><th>Error</th><th>Unit</th></tr></thead><tbody>
<tr><td>Css4j DOM</td><td class="number">2,214.083</td><td class="number">±39.924</td><td>ops/s</td></tr>
<tr><td>JDK</td><td class="number">4,425.948</td><td class="number">±141.463</td><td>ops/s</td></tr>
</tbody></table>
<p>DOM4J is not included as it lacks a <code>NodeIterator</code>.</p>
<p><em>Note:</em> sometimes the <code>NodeIterator</code> created by the JDK is in an inconsistent state, and fails with an exception like:</p>
<pre class="code"># Warmup Iteration   1: <failure>

java.lang.ArrayIndexOutOfBoundsException: Index 34 out of bounds for length 33
        at java.base/java.util.ArrayList.add(ArrayList.java:455)
        at java.base/java.util.ArrayList.add(ArrayList.java:467)
        at java.xml/com.sun.org.apache.xerces.internal.dom.DocumentImpl.createNodeIterator(DocumentImpl.java:255)
        at io.sf.carte.doc.style.css.mark.DOMTraverseMark.markNodeIteratorJdk(DOMTraverseMark.java:122)
</failure></pre>
<p>But I have observed this only while benchmarking, and not in other cases.</p>
</div>
<div class="tema" id="treewalker">
<h2>DOM traversal: <code>TreeWalker</code></h2>
<p>Count the elements of an XML document traversed by a <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/org/w3c/dom/traversal/TreeWalker.html"><code>TreeWalker</code></a>.</p>
<svg version="1.1" baseprofile="full" xmlns="http://www.w3.org/2000/svg" width="700" height="500" viewbox="0 0 700 500" class="carteitem">
<title>DOM Traversal</title><defs>
<clipPath id="treewalker-cut-scale-shadow">
  <rect width="623" height="15" x="71" y="46"></rect>
  <rect width="8" height="418" x="685" y="42"></rect>
</clipPath>
<linearGradient id="treewalker-background" gradientunits="objectBoundingBox" x1="1" x2="1" y1="0" y2="1">
<stop stop-color="#cde1ff" offset="0"></stop>
<stop stop-color="#ffffff" offset="0.9"></stop>
</linearGradient>
<linearGradient id="treewalker-reflection" gradientunits="objectBoundingBox" x1="0" x2="0" y1="0" y2="1">
<stop stop-color="#eeeeee" offset="0" stop-opacity="0.4"></stop>
<stop stop-color="#ffffff" offset="0.75" stop-opacity="0"></stop>
</linearGradient>
<filter id="treewalker-projection" filterunits="objectBoundingBox" x="0" y="-0.1" width="1.2" height="1.2">
<feGaussianBlur in="SourceAlpha" stddeviation="2" result="alpha_blur"></feGaussianBlur>
<feOffset in="alpha_blur" dx="3" dy="-3" result="offset_alpha_blur"></feOffset>
</filter>
</defs>
<style>
text {
  font-family: "Open Sans",Verdana,sans-serif;
}
#caption {
  font-size: 13pt;
  font-weight: 700;
}
#subcaption {
  font-size: 9pt;
  font-weight: 600;
}
#x-title,#y-title{
  font-size: 10pt;
  font-weight: 700;
}
.itemlabel {
  font-size: 10pt;
  font-weight: 400;
}
.scaleItem {
  font-size: 9pt;
  font-weight: 300;
}
</style>
<rect width="100%" height="100%" fill="url('#treewalker-background')"></rect>
<rect width="610" height="400" x="75" y="60" stroke="#000000" fill="rgb(0,0,0)" fill-opacity="0" filter="url('#treewalker-projection')" clip-path="url('#treewalker-cut-scale-shadow')"></rect>
<rect id="treewalker-chartbox" width="610" height="400" x="75" y="60" stroke-width="1" stroke="#000000" fill="rgb(0,0,0)" fill-opacity="0"></rect>
<text id="caption" x="355" y="22" text-anchor="middle" fill="black">DOM Traversal</text>
<text id="subcaption" x="355" y="42" text-anchor="middle" fill="black">1MB file traversed by TreeWalker</text>
<rect width="285.0" height="143.3" x="83" y="316.7" stroke="#ffffff" stroke-opacity="0.4" filter="url('#treewalker-projection')"></rect>
<rect id="treewalker-markTreeWalkerDOM" width="285.0" height="143.3" x="83" y="316.7" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#61c061"></rect>
<rect width="285.0" height="143.3" x="83" y="316.7" fill="url('#treewalker-reflection')"></rect>
<line x1="229.4" x2="229.4" y1="314.5" y2="319.5" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="221.8" y="475" class="itemlabel" text-anchor="middle" fill="black">Css4j DOM</text>
<rect width="285.0" height="300.9" x="388" y="159.1" stroke="#ffffff" stroke-opacity="0.4" filter="url('#treewalker-projection')"></rect>
<rect id="treewalker-markTreeWalkerJdk" width="285.0" height="300.9" x="388" y="159.1" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#c0c061"></rect>
<rect width="285.0" height="300.9" x="388" y="159.1" fill="url('#treewalker-reflection')"></rect>
<line x1="534.4" x2="534.4" y1="146.9" y2="171.1" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="526.8" y="475" class="itemlabel" text-anchor="middle" fill="black">JDK</text>
<text x="74" y="64" class="scaleitem" text-anchor="end">6000</text>
<text x="74" y="197" class="scaleitem" text-anchor="end">4000</text>
<text x="74" y="331" class="scaleitem" text-anchor="end">2000</text>
<text x="74" y="464" class="scaleitem" text-anchor="end">0</text>
<text id="y-title" x="16" y="260" text-anchor="middle" fill="black" transform="rotate(270,16,260)">Throughput (ops/s)</text>
<text id="x-title" x="350" y="496" text-anchor="middle" fill="black"></text>
<image src="benchmark/treewalker.png" xlink:href=""></image></svg>
<p>Numeric results (higher is better):</p>
<table class="normaltbl carteitem">
<thead><tr><th>Implementation</th><th>Score</th><th>Error</th><th>Unit</th></tr></thead><tbody>
<tr><td>Css4j DOM</td><td class="number">2,170.840</td><td class="number">±37.807</td><td>ops/s</td></tr>
<tr><td>JDK</td><td class="number">4,558.830</td><td class="number">±183.012</td><td>ops/s</td></tr>
</tbody></table>
<p>DOM4J provides no <code>TreeWalker</code>.</p>
</div>
<div class="tema" id="element-iterator">
<h2>DOM traversal: <code>elementIterator()</code></h2>
<p>Traverse an XML document using native DOM's <a href="https://css4j.github.io/api/3/io/sf/carte/doc/dom/ParentNode.html#elementIterator()"><code>elementIterator()</code></a>
and DOM4J's <a href="https://dom4j.github.io/javadoc/2.1.3/org/dom4j/Element.html#elementIterator--"><code>elementIterator()</code></a>.</p>
<svg version="1.1" baseprofile="full" xmlns="http://www.w3.org/2000/svg" width="700" height="500" viewbox="0 0 700 500" class="carteitem">
<title>DOM Traversal</title><defs>
<clipPath id="element-iterator-cut-scale-shadow">
  <rect width="623" height="15" x="71" y="46"></rect>
  <rect width="8" height="418" x="685" y="42"></rect>
</clipPath>
<linearGradient id="element-iterator-background" gradientunits="objectBoundingBox" x1="1" x2="1" y1="0" y2="1">
<stop stop-color="#cde1ff" offset="0"></stop>
<stop stop-color="#ffffff" offset="0.9"></stop>
</linearGradient>
<linearGradient id="element-iterator-reflection" gradientunits="objectBoundingBox" x1="0" x2="0" y1="0" y2="1">
<stop stop-color="#eeeeee" offset="0" stop-opacity="0.4"></stop>
<stop stop-color="#ffffff" offset="0.75" stop-opacity="0"></stop>
</linearGradient>
<filter id="element-iterator-projection" filterunits="objectBoundingBox" x="0" y="-0.1" width="1.2" height="1.2">
<feGaussianBlur in="SourceAlpha" stddeviation="2" result="alpha_blur"></feGaussianBlur>
<feOffset in="alpha_blur" dx="3" dy="-3" result="offset_alpha_blur"></feOffset>
</filter>
</defs>
<style>
text {
  font-family: "Open Sans",Verdana,sans-serif;
}
#caption {
  font-size: 13pt;
  font-weight: 700;
}
#subcaption {
  font-size: 9pt;
  font-weight: 600;
}
#x-title,#y-title{
  font-size: 10pt;
  font-weight: 700;
}
.itemlabel {
  font-size: 10pt;
  font-weight: 400;
}
.scaleItem {
  font-size: 9pt;
  font-weight: 300;
}
</style>
<rect width="100%" height="100%" fill="url('#element-iterator-background')"></rect>
<rect width="610" height="400" x="75" y="60" stroke="#000000" fill="rgb(0,0,0)" fill-opacity="0" filter="url('#element-iterator-projection')" clip-path="url('#element-iterator-cut-scale-shadow')"></rect>
<rect id="element-iterator-chartbox" width="610" height="400" x="75" y="60" stroke-width="1" stroke="#000000" fill="rgb(0,0,0)" fill-opacity="0"></rect>
<text id="caption" x="355" y="22" text-anchor="middle" fill="black">DOM Traversal</text>
<text id="subcaption" x="355" y="42" text-anchor="middle" fill="black">1MB file traversed by elementIterator()</text>
<rect width="285.0" height="337.6" x="83" y="122.4" stroke="#ffffff" stroke-opacity="0.4" filter="url('#element-iterator-projection')"></rect>
<rect id="element-iterator-markIteratorDOM" width="285.0" height="337.6" x="83" y="122.4" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#61c061"></rect>
<rect width="285.0" height="337.6" x="83" y="122.4" fill="url('#element-iterator-reflection')"></rect>
<line x1="229.4" x2="229.4" y1="93.7" y2="150.3" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="221.8" y="475" class="itemlabel" text-anchor="middle" fill="black">Css4j DOM</text>
<rect width="285.0" height="84.5" x="388" y="375.5" stroke="#ffffff" stroke-opacity="0.4" filter="url('#element-iterator-projection')"></rect>
<rect id="element-iterator-markIteratorDOM4J" width="285.0" height="84.5" x="388" y="375.5" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#4d4dc0"></rect>
<rect width="285.0" height="84.5" x="388" y="375.5" fill="url('#element-iterator-reflection')"></rect>
<line x1="534.4" x2="534.4" y1="371.5" y2="378.5" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="526.8" y="475" class="itemlabel" text-anchor="middle" fill="black">DOM4J</text>
<text x="74" y="64" class="scaleitem" text-anchor="end">2600</text>
<text x="74" y="95" class="scaleitem" text-anchor="end">2400</text>
<text x="74" y="126" class="scaleitem" text-anchor="end">2200</text>
<text x="74" y="156" class="scaleitem" text-anchor="end">2000</text>
<text x="74" y="187" class="scaleitem" text-anchor="end">1800</text>
<text x="74" y="218" class="scaleitem" text-anchor="end">1600</text>
<text x="74" y="249" class="scaleitem" text-anchor="end">1400</text>
<text x="74" y="279" class="scaleitem" text-anchor="end">1200</text>
<text x="74" y="310" class="scaleitem" text-anchor="end">1000</text>
<text x="74" y="341" class="scaleitem" text-anchor="end">800</text>
<text x="74" y="372" class="scaleitem" text-anchor="end">600</text>
<text x="74" y="402" class="scaleitem" text-anchor="end">400</text>
<text x="74" y="433" class="scaleitem" text-anchor="end">200</text>
<text x="74" y="464" class="scaleitem" text-anchor="end">0</text>
<text id="y-title" x="16" y="260" text-anchor="middle" fill="black" transform="rotate(270,16,260)">Throughput (ops/s)</text>
<text id="x-title" x="350" y="496" text-anchor="middle" fill="black"></text>
<image src="benchmark/element-iterator.png" xlink:href=""></image></svg>
<p>Numeric results (higher is better):</p>
<table class="normaltbl carteitem">
<thead><tr><th>Implementation</th><th>Score</th><th>Error</th><th>Unit</th></tr></thead><tbody>
<tr><td>Css4j DOM</td><td class="number">2,216.815</td><td class="number">±185.831</td><td>ops/s</td></tr>
<tr><td>DOM4J</td><td class="number">554.890</td><td class="number">±22.921</td><td>ops/s</td></tr>
</tbody></table>
<p>The JDK's DOM provides no element iterator.</p>
</div>
<div class="tema" id="elements-by-tagname">
<h2>DOM traversal: <code>getElementsByTagName()</code></h2>
<p>Traverse the list given by <code>getElementsByTagName()</code>. In the case of css4j's native DOM, there are two results: one iterating the
<a href="https://dom.spec.whatwg.org/#interface-nodelist"><code>NodeList</code></a> by the <code>item()</code> method, and another via the iterator
(the returned <code>NodeList</code> implements <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html"><code>Iterable</code></a>).</p>
<svg version="1.1" baseprofile="full" xmlns="http://www.w3.org/2000/svg" width="700" height="500" viewbox="0 0 700 500" class="carteitem">
<title>DOM Traversal</title><defs>
<clipPath id="elements-by-tagname-cut-scale-shadow">
  <rect width="623" height="15" x="71" y="46"></rect>
  <rect width="8" height="418" x="685" y="42"></rect>
</clipPath>
<linearGradient id="elements-by-tagname-background" gradientunits="objectBoundingBox" x1="1" x2="1" y1="0" y2="1">
<stop stop-color="#cde1ff" offset="0"></stop>
<stop stop-color="#ffffff" offset="0.9"></stop>
</linearGradient>
<linearGradient id="elements-by-tagname-reflection" gradientunits="objectBoundingBox" x1="0" x2="0" y1="0" y2="1">
<stop stop-color="#eeeeee" offset="0" stop-opacity="0.4"></stop>
<stop stop-color="#ffffff" offset="0.75" stop-opacity="0"></stop>
</linearGradient>
<filter id="elements-by-tagname-projection" filterunits="objectBoundingBox" x="0" y="-0.1" width="1.2" height="1.2">
<feGaussianBlur in="SourceAlpha" stddeviation="2" result="alpha_blur"></feGaussianBlur>
<feOffset in="alpha_blur" dx="3" dy="-3" result="offset_alpha_blur"></feOffset>
</filter>
</defs>
<style>
text {
  font-family: "Open Sans",Verdana,sans-serif;
}
#caption {
  font-size: 13pt;
  font-weight: 700;
}
#subcaption {
  font-size: 9pt;
  font-weight: 600;
}
#x-title,#y-title{
  font-size: 10pt;
  font-weight: 700;
}
.itemlabel {
  font-size: 10pt;
  font-weight: 400;
}
.scaleItem {
  font-size: 9pt;
  font-weight: 300;
}
</style>
<rect width="100%" height="100%" fill="url('#elements-by-tagname-background')"></rect>
<rect width="610" height="400" x="75" y="60" stroke="#000000" fill="rgb(0,0,0)" fill-opacity="0" filter="url('#elements-by-tagname-projection')" clip-path="url('#elements-by-tagname-cut-scale-shadow')"></rect>
<rect id="elements-by-tagname-chartbox" width="610" height="400" x="75" y="60" stroke-width="1" stroke="#000000" fill="rgb(0,0,0)" fill-opacity="0"></rect>
<text id="caption" x="355" y="22" text-anchor="middle" fill="black">DOM Traversal</text>
<text id="subcaption" x="355" y="42" text-anchor="middle" fill="black">Traverse 3152 elements given by getElementsByTagName()</text>
<rect width="138.0" height="0.3" x="80.8" y="459.7" stroke="#ffffff" stroke-opacity="0.4" filter="url('#elements-by-tagname-projection')"></rect>
<rect id="elements-by-tagname-markElementsByTagNameDOM" width="138.0" height="0.3" x="80.8" y="459.7" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#61c061"></rect>
<rect width="138.0" height="0.3" x="80.8" y="459.7" fill="url('#elements-by-tagname-reflection')"></rect>
<line x1="154" x2="154" y1="460" y2="460" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="150.2" y="475" class="itemlabel" text-anchor="middle" fill="black">Css4j DOM</text>
<rect width="138.0" height="81.3" x="233.3" y="378.7" stroke="#ffffff" stroke-opacity="0.4" filter="url('#elements-by-tagname-projection')"></rect>
<rect id="elements-by-tagname-markElementsByTagNameDOM4J" width="138.0" height="81.3" x="233.3" y="378.7" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#c04d4d"></rect>
<rect width="138.0" height="81.3" x="233.3" y="378.7" fill="url('#elements-by-tagname-reflection')"></rect>
<line x1="306.5" x2="306.5" y1="377.6" y2="380.4" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="302.7" y="475" class="itemlabel" text-anchor="middle" fill="black">Css4j-DOM4J</text>
<rect width="138.0" height="273.7" x="385.8" y="186.3" stroke="#ffffff" stroke-opacity="0.4" filter="url('#elements-by-tagname-projection')"></rect>
<rect id="elements-by-tagname-markElementsByTagNameDOMit" width="138.0" height="273.7" x="385.8" y="186.3" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#c04dc0"></rect>
<rect width="138.0" height="273.7" x="385.8" y="186.3" fill="url('#elements-by-tagname-reflection')"></rect>
<line x1="459" x2="459" y1="159.5" y2="212.5" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="455.2" y="475" class="itemlabel" text-anchor="middle" fill="black">Css4j DOM (iterator)</text>
<rect width="138.0" height="371.8" x="538.3" y="88.2" stroke="#ffffff" stroke-opacity="0.4" filter="url('#elements-by-tagname-projection')"></rect>
<rect id="elements-by-tagname-markElementsByTagNameJdk" width="138.0" height="371.8" x="538.3" y="88.2" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#c0c061"></rect>
<rect width="138.0" height="371.8" x="538.3" y="88.2" fill="url('#elements-by-tagname-reflection')"></rect>
<line x1="611.5" x2="611.5" y1="75.4" y2="100.6" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="607.7" y="475" class="itemlabel" text-anchor="middle" fill="black">JDK</text>
<text x="74" y="64" class="scaleitem" text-anchor="end">2600</text>
<text x="74" y="95" class="scaleitem" text-anchor="end">2400</text>
<text x="74" y="126" class="scaleitem" text-anchor="end">2200</text>
<text x="74" y="156" class="scaleitem" text-anchor="end">2000</text>
<text x="74" y="187" class="scaleitem" text-anchor="end">1800</text>
<text x="74" y="218" class="scaleitem" text-anchor="end">1600</text>
<text x="74" y="249" class="scaleitem" text-anchor="end">1400</text>
<text x="74" y="279" class="scaleitem" text-anchor="end">1200</text>
<text x="74" y="310" class="scaleitem" text-anchor="end">1000</text>
<text x="74" y="341" class="scaleitem" text-anchor="end">800</text>
<text x="74" y="372" class="scaleitem" text-anchor="end">600</text>
<text x="74" y="402" class="scaleitem" text-anchor="end">400</text>
<text x="74" y="433" class="scaleitem" text-anchor="end">200</text>
<text x="74" y="464" class="scaleitem" text-anchor="end">0</text>
<text id="y-title" x="16" y="260" text-anchor="middle" fill="black" transform="rotate(270,16,260)">Throughput (ops/s)</text>
<text id="x-title" x="350" y="496" text-anchor="middle" fill="black"></text>
<image src="benchmark/elements-by-tagname.png" xlink:href=""></image></svg>
<p>Numeric results (higher is better):</p>
<table class="normaltbl carteitem">
<thead><tr><th>Implementation</th><th>Score</th><th>Error</th><th>Unit</th></tr></thead><tbody>
<tr><td>Css4j DOM</td><td class="number">2.2585</td><td class="number">±0.0571</td><td>ops/s</td></tr>
<tr><td>Css4j-DOM4J</td><td class="number">533.7092</td><td class="number">±9.1267</td><td>ops/s</td></tr>
<tr><td>Css4j DOM (iterator)</td><td class="number">1,797.2333</td><td class="number">±173.7811</td><td>ops/s</td></tr>
<tr><td>JDK</td><td class="number">2,441.1572</td><td class="number">±82.5474</td><td>ops/s</td></tr>
</tbody></table>
<p><em>Note:</em> the iterator is documented as the recommended way to traverse the <a href="https://css4j.github.io/api/3/io/sf/carte/doc/dom/ElementList.html"><code>ElementList</code></a> in css4j since version 3.2. Css4j versions prior to 3.2 perform much better in this benchmark,
but the implementation was switched to one that is more lightweight (and the iterator performance is good enough).</p>
</div>
<div class="tema" id="dom-change">
<h2>DOM modification: <code>appendChild()/removeChild()</code></h2>
<p>Modify the nodes of an XML document by appending elements with <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/org/w3c/dom/Node.html#appendChild(org.w3c.dom.Node)"><code>appendChild()</code></a> and later removing them with
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/org/w3c/dom/Node.html#removeChild(org.w3c.dom.Node)"><code>removeChild()</code></a>.</p>
<svg version="1.1" baseprofile="full" xmlns="http://www.w3.org/2000/svg" width="700" height="500" viewbox="0 0 700 500" class="carteitem">
<title>DOM document modification</title><defs>
<clipPath id="dom-change-cut-scale-shadow">
  <rect width="623" height="15" x="71" y="46"></rect>
  <rect width="8" height="418" x="685" y="42"></rect>
</clipPath>
<linearGradient id="dom-change-background" gradientunits="objectBoundingBox" x1="1" x2="1" y1="0" y2="1">
<stop stop-color="#cde1ff" offset="0"></stop>
<stop stop-color="#ffffff" offset="0.9"></stop>
</linearGradient>
<linearGradient id="dom-change-reflection" gradientunits="objectBoundingBox" x1="0" x2="0" y1="0" y2="1">
<stop stop-color="#eeeeee" offset="0" stop-opacity="0.4"></stop>
<stop stop-color="#ffffff" offset="0.75" stop-opacity="0"></stop>
</linearGradient>
<filter id="dom-change-projection" filterunits="objectBoundingBox" x="0" y="-0.1" width="1.2" height="1.2">
<feGaussianBlur in="SourceAlpha" stddeviation="2" result="alpha_blur"></feGaussianBlur>
<feOffset in="alpha_blur" dx="3" dy="-3" result="offset_alpha_blur"></feOffset>
</filter>
</defs>
<style>
text {
  font-family: "Open Sans",Verdana,sans-serif;
}
#caption {
  font-size: 13pt;
  font-weight: 700;
}
#subcaption {
  font-size: 9pt;
  font-weight: 600;
}
#x-title,#y-title{
  font-size: 10pt;
  font-weight: 700;
}
.itemlabel {
  font-size: 10pt;
  font-weight: 400;
}
.scaleItem {
  font-size: 9pt;
  font-weight: 300;
}
</style>
<rect width="100%" height="100%" fill="url('#dom-change-background')"></rect>
<rect width="610" height="400" x="75" y="60" stroke="#000000" fill="rgb(0,0,0)" fill-opacity="0" filter="url('#dom-change-projection')" clip-path="url('#dom-change-cut-scale-shadow')"></rect>
<rect id="dom-change-chartbox" width="610" height="400" x="75" y="60" stroke-width="1" stroke="#000000" fill="rgb(0,0,0)" fill-opacity="0"></rect>
<text id="caption" x="355" y="22" text-anchor="middle" fill="black">DOM document modification</text>
<text id="subcaption" x="355" y="42" text-anchor="middle" fill="black">appendChild()/removeChild()</text>
<rect width="187.0" height="235.4" x="81.5" y="224.6" stroke="#ffffff" stroke-opacity="0.4" filter="url('#dom-change-projection')"></rect>
<rect id="dom-change-markChangeDOM" width="187.0" height="235.4" x="81.5" y="224.6" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#61c061"></rect>
<rect width="187.0" height="235.4" x="81.5" y="224.6" fill="url('#dom-change-reflection')"></rect>
<line x1="179.1" x2="179.1" y1="220.2" y2="229.8" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="174.1" y="475" class="itemlabel" text-anchor="middle" fill="black">Css4j DOM</text>
<rect width="187.0" height="59.2" x="284.9" y="400.8" stroke="#ffffff" stroke-opacity="0.4" filter="url('#dom-change-projection')"></rect>
<rect id="dom-change-markChangeDOM4J" width="187.0" height="59.2" x="284.9" y="400.8" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#c04d4d"></rect>
<rect width="187.0" height="59.2" x="284.9" y="400.8" fill="url('#dom-change-reflection')"></rect>
<line x1="382.5" x2="382.5" y1="400.2" y2="401.8" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="377.4" y="475" class="itemlabel" text-anchor="middle" fill="black">Css4j-DOM4J</text>
<rect width="187.0" height="365.9" x="488.2" y="94.1" stroke="#ffffff" stroke-opacity="0.4" filter="url('#dom-change-projection')"></rect>
<rect id="dom-change-markChangeJdk" width="187.0" height="365.9" x="488.2" y="94.1" stroke="black" stroke-width="0.4" stroke-opacity="0.3" fill="#c0c061"></rect>
<rect width="187.0" height="365.9" x="488.2" y="94.1" fill="url('#dom-change-reflection')"></rect>
<line x1="585.8" x2="585.8" y1="76.6" y2="111.4" stroke="#888888" stroke-opacity="0.867" stroke-width="5" stroke-linecap="round" stroke-dasharray="1" class="errorbar"></line>
<text x="580.7" y="475" class="itemlabel" text-anchor="middle" fill="black">JDK</text>
<text x="74" y="64" class="scaleitem" text-anchor="end">800</text>
<text x="74" y="164" class="scaleitem" text-anchor="end">600</text>
<text x="74" y="264" class="scaleitem" text-anchor="end">400</text>
<text x="74" y="364" class="scaleitem" text-anchor="end">200</text>
<text x="74" y="464" class="scaleitem" text-anchor="end">0</text>
<text id="y-title" x="16" y="260" text-anchor="middle" fill="black" transform="rotate(270,16,260)">Throughput (ops/s)</text>
<text id="x-title" x="350" y="496" text-anchor="middle" fill="black"></text>
<image src="benchmark/dom-change.png" xlink:href=""></image></svg>
<p>Numeric results (higher is better):</p>
<table class="normaltbl carteitem">
<thead><tr><th>Implementation</th><th>Score</th><th>Error</th><th>Unit</th></tr></thead><tbody>
<tr><td>Css4j DOM</td><td class="number">475.569</td><td class="number">±9.618</td><td>ops/s</td></tr>
<tr><td>Css4j-DOM4J</td><td class="number">119.608</td><td class="number">±1.559</td><td>ops/s</td></tr>
<tr><td>JDK</td><td class="number">739.128</td><td class="number">±35.094</td><td>ops/s</td></tr>
</tbody></table>
</div>
<div class="tema" id="analysis">
<h2>Analysis</h2>
<p>Building a document with DOM4J (both plain DOM4J and the CSS-enabled subclasses that CSS4J provide) is fast, but has an important scalability problem. If you use
instances of DOM4J simultaneously in the same JVM, contention happens even if no common resources are explicitly accessed. This is due to DOM4J using a <code>static</code> synchronized cache of <code>QName</code> objects,
as shown by the benchmark profiler (e.g. <code>java -jar build/benchmarks.jar XMLBuildBenchmark -prof stack:lines=5;top=3;detailLine=true;period=1</code>):</p>
<pre class="code">Secondary result "io.sf.carte.doc.style.css.mark.XMLBuildBenchmark.markBuildDOM4J: stack":
Stack profiler:

....[Thread state distributions]....................................................................
 72,3%         BLOCKED
 27,6%         RUNNABLE

....[Thread state: BLOCKED].........................................................................
 72,3% 100,0% java.util.Collections$SynchronizedMap.get
              org.dom4j.tree.QNameCache.get
              org.dom4j.DocumentFactory.createQName
              org.dom4j.tree.NamespaceStack.createQName
              org.dom4j.tree.NamespaceStack.pushQName
</pre>
<p>So its usage is not recommended for multi-core systems.</p>
<p>Css4j's native DOM has more features than the other contenders but is slower than the JDK's DOM, otherwise shows reasonable speeds. The DOM implementation that comes bundled with the JDK is the fastest,
and looks like a good choice for applications that do not require handling styles (or you could use the read-only DOM wrapper with it, if that fits your needs).
Finally, DOM4J is lagging behind in performance for anything other than document build-up.</p>
</div>
</div>
<div class="footnote">
</div>
</div>
</div>
</body></html>